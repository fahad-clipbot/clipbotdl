# ๐ง ุฏููู ุฅุนุฏุงุฏ ูุธุงู ุงูุงุดุชุฑุงูุงุช
# Subscription System Setup Guide

ุฏููู ุดุงูู ูุฅุนุฏุงุฏ ูุชุดุบูู ูุธุงู ุงูุงุดุชุฑุงูุงุช ุงููุฏููุนุฉ.

---

## ๐ ุงููุชุทูุจุงุช

### 1. ุญุณุงุจ Stripe (ููุฏูุน)

**ุงูุฎุทูุงุช:**
1. ุงุฐูุจ ุฅูู [stripe.com](https://stripe.com)
2. ุฃูุดุฆ ุญุณุงุจุงู ุฌุฏูุฏุงู
3. ุชุญูู ูู ุจุฑูุฏู ุงูุฅููุชุฑููู
4. ุงูุชูู ุฅูู ููุญุฉ ุงูุชุญูู

**ุงูุญุตูู ุนูู ุงูููุงุชูุญ:**
1. ุงุฐูุจ ุฅูู **Developers** โ **API Keys**
2. ุงูุณุฎ **Publishable Key** ู **Secret Key**
3. ุงุญูุธููุง ูู ููู `.env`

---

## ๐ ุฎุทูุงุช ุงูุฅุนุฏุงุฏ

### ุงูุฎุทูุฉ 1: ุชุซุจูุช ุงูููุชุจุงุช ุงูุฅุถุงููุฉ

```bash
pip install stripe
pip install python-telegram-bot
pip install python-dotenv
```

ุฃู ุงุณุชุฎุฏู:
```bash
pip install -r requirements.txt
```

### ุงูุฎุทูุฉ 2: ุฅุนุฏุงุฏ ูุชุบูุฑุงุช ุงูุจูุฆุฉ

ุฃูุดุฆ ููู `.env` ูุฃุถู:

```env
# Telegram
TELEGRAM_BOT_TOKEN=YOUR_BOT_TOKEN_HERE

# Stripe
STRIPE_API_KEY=sk_test_YOUR_SECRET_KEY
STRIPE_WEBHOOK_SECRET=whsec_YOUR_WEBHOOK_SECRET

# Database
DATABASE_PATH=subscriptions.db
```

### ุงูุฎุทูุฉ 3: ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช

```bash
python3 database_models.py
```

ูุฐุง ุณููุดุฆ ููู `subscriptions.db` ูุน ุฌููุน ุงูุฌุฏุงูู.

### ุงูุฎุทูุฉ 4: ุชุดุบูู ุงูุจูุช

```bash
python3 bot_with_subscriptions.py
```

---

## ๐ ูููู ุงููุธุงู

### ูุงุนุฏุฉ ุงูุจูุงูุงุช

```
subscriptions.db
โโโ users (ุงููุณุชุฎุฏููู)
โโโ subscriptions (ุงูุงุดุชุฑุงูุงุช)
โโโ payments (ุงููุฏููุนุงุช)
โโโ usage (ุงูุงุณุชุฎุฏุงู)
โโโ promo_codes (ุฃููุงุฏ ุงูุฎุตู)
```

### ุงููููุงุช ุงูุฑุฆูุณูุฉ

| ุงูููู | ุงููุตู |
|------|-------|
| `database_models.py` | ููุงุฐุฌ ูุงุนุฏุฉ ุงูุจูุงูุงุช |
| `bot_with_subscriptions.py` | ุงูุจูุช ูุน ุงูุงุดุชุฑุงูุงุช |
| `payment_system.py` | ูุธุงู ุงูุฏูุน ูุน Stripe |
| `subscription_system.py` | ูุธุงู ุฅุฏุงุฑุฉ ุงูุงุดุชุฑุงูุงุช |

---

## ๐ฏ ุฎุทุท ุงูุงุดุชุฑุงู

### ุงูุฎุทุฉ ุงููุฌุงููุฉ (Free)
- **ุงูุณุนุฑ:** $0
- **ุงูุชูุฒููุงุช ุงูููููุฉ:** 5
- **ุงูุฅุนูุงูุงุช:** ูุนู
- **ุงูุฏุนู:** ูุง

### ุงูุฎุทุฉ ุงูุฃุณุงุณูุฉ (Basic)
- **ุงูุณุนุฑ:** $2.99/ุดูุฑ
- **ุงูุชูุฒููุงุช ุงูููููุฉ:** ุบูุฑ ูุญุฏูุฏ
- **ุงูุฅุนูุงูุงุช:** ูุง
- **ุงูุฏุนู:** ูุง

### ุงูุฎุทุฉ ุงูุงุญุชุฑุงููุฉ (Pro)
- **ุงูุณุนุฑ:** $4.99/ุดูุฑ
- **ุงูุชูุฒููุงุช ุงูููููุฉ:** ุบูุฑ ูุญุฏูุฏ
- **ุงูุชูุฒูู ุงูุณุฑูุน:** ูุนู
- **ุงูุฏุนู:** ูุนู

### ุงูุฎุทุฉ ุงููุชูุฏูุฉ (Premium)
- **ุงูุณุนุฑ:** $9.99/ุดูุฑ
- **ุฌููุน ุงูููุฒุงุช:** ูุนู
- **ูุตูู API:** ูุนู
- **ุฅุญุตุงุฆูุงุช ูุชูุฏูุฉ:** ูุนู

---

## ๐ณ ุนูููุฉ ุงูุฏูุน

### 1. ุงููุณุชุฎุฏู ูุฎุชุงุฑ ุฎุทุฉ

```
ุงููุณุชุฎุฏู
   โ
/subscribe ุฃู ุงุถุบุท "ุนุฑุถ ุงูุฎุทุท"
   โ
ูุฎุชุงุฑ ุฎุทุฉ
```

### 2. ุฅูุดุงุก ุฌูุณุฉ ุฏูุน

```
ุงุฎุชูุงุฑ ุงูุฎุทุฉ
   โ
ุฅูุดุงุก ุนููู Stripe
   โ
ุฅูุดุงุก ุฌูุณุฉ ุฏูุน
   โ
ุฅุฑุณุงู ุฑุงุจุท ุงูุฏูุน
```

### 3. ุงูุฏูุน

```
ุฑุงุจุท ุงูุฏูุน
   โ
ุตูุญุฉ Stripe
   โ
ุฅุฏุฎุงู ุจูุงูุงุช ุงูุจุทุงูุฉ
   โ
ุชุฃููุฏ ุงูุฏูุน
```

### 4. ุชูุนูู ุงูุงุดุชุฑุงู

```
ุฏูุน ูุงุฌุญ
   โ
webhook ูู Stripe
   โ
ุชุฑููุฉ ุงูุงุดุชุฑุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
   โ
ุฅุฑุณุงู ุฑุณุงูุฉ ุชุฃููุฏ ูููุณุชุฎุฏู
```

---

## ๐ ุฅุนุฏุงุฏ Webhooks

### ููุงุฐุง ูุญุชุงุฌ Webhooksุ

Webhooks ุชุณูุญ ูู Stripe ุจุฅุฎุจุงุฑ ุงูุจูุช ุนูุฏูุง ูุญุฏุซ ุดูุก ูุง (ุฏูุน ูุงุฌุญุ ูุดูุ ุฅูุบุงุกุ ุฅูุฎ).

### ุฎุทูุงุช ุงูุฅุนุฏุงุฏ:

1. **ุงุฐูุจ ุฅูู Stripe Dashboard**
   - Developers โ Webhooks

2. **ุฃุถู Endpoint ุฌุฏูุฏ**
   - URL: `https://your-bot-url.com/webhook/stripe`
   - Events: ุงุฎุชุฑ ุงูุฃุญุฏุงุซ ุงููููุฉ

3. **ุงูุฃุญุฏุงุซ ุงููููุฉ:**
   - `customer.subscription.created` - ุงุดุชุฑุงู ุฌุฏูุฏ
   - `customer.subscription.updated` - ุชุญุฏูุซ ุงูุงุดุชุฑุงู
   - `customer.subscription.deleted` - ุฅูุบุงุก ุงูุงุดุชุฑุงู
   - `invoice.payment_succeeded` - ุฏูุน ูุงุฌุญ
   - `invoice.payment_failed` - ูุดู ุงูุฏูุน

4. **ุงูุณุฎ Signing Secret**
   - ุถุนู ูู `.env` ูู `STRIPE_WEBHOOK_SECRET`

---

## ๐ฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ุงูุฃูุงูุฑ ุงููุชุงุญุฉ

```
/start          - ุงูุจุฏุก ูุงูุชุฑุญูุจ
/subscribe      - ุนุฑุถ ุฎุทุท ุงูุงุดุชุฑุงู
/status         - ุญุงูุฉ ุงูุงุดุชุฑุงู ุงูุญุงูู
/help           - ุงููุณุงุนุฏุฉ
```

### ุงูุฃุฒุฑุงุฑ ุงูุชูุงุนููุฉ

```
๐ฆ ุนุฑุถ ุงูุฎุทุท
   โโ ุงุดุชุฑู ูู ุฃุณุงุณู ($2.99)
   โโ ุงุดุชุฑู ูู ุงุญุชุฑุงูู ($4.99)
   โโ ุงุดุชุฑู ูู ูุชูุฏู ($9.99)

๐ ุญุงูุฉ ุงูุงุดุชุฑุงู
   โโ ุนุฑุถ ุชูุงุตูู ุงูุงุดุชุฑุงู

โ ุงููุณุงุนุฏุฉ
   โโ ูุตุงุฆุญ ูุญูู
```

---

## ๐ ุงูุฃูุงู

### ูุตุงุฆุญ ุฃูุงู ูููุฉ

1. **ุญูุงูุฉ ุงูููุงุชูุญ**
   - ูุง ุชุดุงุฑู `STRIPE_API_KEY`
   - ูุง ุชุถุนู ูู GitHub
   - ุงุณุชุฎุฏู `.env` ู `.gitignore`

2. **ุงูุชุญูู ูู Webhooks**
   - ุชุญูู ูู ุงูุชูููุน (Signature)
   - ุงุณุชุฎุฏู `STRIPE_WEBHOOK_SECRET`

3. **ุญูุงูุฉ ุงูุจูุงูุงุช**
   - ูุง ุชุฎุฒู ุจูุงูุงุช ุงูุจุทุงูุฉ
   - ุงุณุชุฎุฏู Stripe ููุฏูุน ููุท
   - ุดููุฑ ูููุงุช ุงููุฑูุฑ

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุงูุงุฎุชุจุงุฑ ุงููุญูู

```bash
# ุชุดุบูู ุงูุจูุช
python3 bot_with_subscriptions.py

# ุงุฎุชุจุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช
python3 database_models.py

# ุงุฎุชุจุงุฑ ูุธุงู ุงูุฏูุน
python3 payment_system.py
```

### ุจูุงูุงุช ุงุฎุชุจุงุฑ Stripe

**ุจุทุงูุงุช ุงูุงุฎุชุจุงุฑ:**

| ุงูููุน | ุงูุฑูู | ุงูุญุงูุฉ |
|------|------|--------|
| Visa | 4242 4242 4242 4242 | โ ูุงุฌุญ |
| Visa | 4000 0000 0000 0002 | โ ูุฑููุถ |
| Amex | 3782 822463 10005 | โ ูุงุฌุญ |

**ุชุงุฑูุฎ ุงูุงูุชูุงุก:** ุฃู ุชุงุฑูุฎ ูุณุชูุจูู
**CVC:** ุฃู 3 ุฃุฑูุงู

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ูุงูุชูุงุฑูุฑ

### ุงูุญุตูู ุนูู ุงูุฅุญุตุงุฆูุงุช

```python
from database_models import Database

db = Database()

# ุฅุญุตุงุฆูุงุช ุนุงูุฉ
stats = db.get_statistics()
print(f"ุฅุฌูุงูู ุงููุณุชุฎุฏููู: {stats['total_users']}")
print(f"ุงูุงุดุชุฑุงูุงุช ุงููุดุทุฉ: {stats['active_subscriptions']}")
print(f"ุฅุฌูุงูู ุงูุฅูุฑุงุฏุงุช: ${stats['total_revenue']}")

# ุฅุญุตุงุฆูุงุช ุงูุงุดุชุฑุงูุงุช
sub_stats = db.get_subscription_stats()
print(f"ุงููุณุชุฎุฏููู ุงููุฌุงูููู: {sub_stats['free']}")
print(f"ุงููุดุชุฑููู ุงูุฃุณุงุณููู: {sub_stats['basic']}")
```

### ุงูุชูุงุฑูุฑ ุงููููุฉ

1. **ุชูุฑูุฑ ุงูุฅูุฑุงุฏุงุช ุงูุดูุฑู**
   - ุฅุฌูุงูู ุงูุฏูุนุงุช
   - ุนุฏุฏ ุงูุงุดุชุฑุงูุงุช ุงูุฌุฏูุฏุฉ
   - ูุนุฏู ุงูุงุญุชูุงุธ

2. **ุชูุฑูุฑ ุงููุณุชุฎุฏููู**
   - ุนุฏุฏ ุงููุณุชุฎุฏููู ุงูุฌุฏุฏ
   - ุงููุณุชุฎุฏููู ุงููุดุทูู
   - ูุนุฏู ุงููุฑุงุฑ

3. **ุชูุฑูุฑ ุงูุงุณุชุฎุฏุงู**
   - ุนุฏุฏ ุงูุชูุฒููุงุช
   - ุงูููุตุงุช ุงูุฃูุซุฑ ุงุณุชุฎุฏุงูุงู
   - ุฃููุงุช ุงูุฐุฑูุฉ

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: "STRIPE_API_KEY not found"

**ุงูุญู:**
1. ุชุฃูุฏ ูู ูุฌูุฏ ููู `.env`
2. ุชุฃูุฏ ูู ูุฌูุฏ `STRIPE_API_KEY` ูู ุงูููู
3. ุฃุนุฏ ุชุดุบูู ุงูุจูุช

### ุงููุดููุฉ: "Database error"

**ุงูุญู:**
```bash
# ุญุฐู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุฏููุฉ
rm subscriptions.db

# ุฅูุดุงุก ูุงุนุฏุฉ ุฌุฏูุฏุฉ
python3 database_models.py
```

### ุงููุดููุฉ: "Webhook not received"

**ุงูุญู:**
1. ุชุฃูุฏ ูู ุฃู URL ุตุญูุญ
2. ุชุฃูุฏ ูู ุฃู ุงูุฎุงุฏู ูุนูู
3. ุชุญูู ูู `STRIPE_WEBHOOK_SECRET`

---

## ๐ ุงูุชุทููุฑ ุงููุณุชูุจูู

### ููุฒุงุช ูุฎุทุท ุฅุถุงูุชูุง

- [ ] ูุธุงู ุงูุฎุตููุงุช ูุงูุฃููุงุฒ ุงูุชุฑููุฌูุฉ
- [ ] ุจุฑูุงูุฌ ุงูุฅุญุงูุฉ (Referral)
- [ ] ุงูุฏูุน ุจุนููุงุช ุฃุฎุฑู
- [ ] ุฏุนู PayPal
- [ ] ููุญุฉ ุชุญูู ููุฅุฏุงุฑุฉ
- [ ] ุชูุงุฑูุฑ ูุชูุฏูุฉ
- [ ] ุฅุดุนุงุฑุงุช ุจุฑูุฏ ุฅููุชุฑููู

---

## ๐ ุงูุฏุนู ูุงููุณุงุนุฏุฉ

### ุงูููุงุฑุฏ ุงููููุฏุฉ

- [Stripe Documentation](https://stripe.com/docs)
- [Telegram Bot API](https://core.telegram.org/bots/api)
- [Python Telegram Bot](https://python-telegram-bot.readthedocs.io/)

### ุงูุงุชุตุงู ุจุงูุฏุนู

- ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: support@example.com
- ุชูู ุชูู: @support_account
- ุชููุชุฑ: @support_account

---

**ุขุฎุฑ ุชุญุฏูุซ:** ููููุจุฑ 2024
**ุงููุคูู:** Manus AI
